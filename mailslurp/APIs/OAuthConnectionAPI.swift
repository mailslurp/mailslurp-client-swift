//
// OAuthConnectionAPI.swift
//
// Generated by openapi-generator
// https://openapi-generator.tech
//

import Foundation
import PromiseKit
#if canImport(AnyCodable)
import AnyCodable
#endif

@objcMembers open class OAuthConnectionAPI : NSObject {

    /**
     * enum for parameter oAuthConnectionType
     */
    public enum OAuthConnectionType_createOAuthConnection: String, CaseIterable {
        case google = "GOOGLE"
        case microsoft = "MICROSOFT"
    }

    /**
     Create an OAuth connection
     
     - parameter redirectBase: (query)  
     - parameter oAuthConnectionType: (query)  
     - parameter emailAddress: (query)  (optional)
     - returns: Promise<CreateOAuthConnectionResult>
     */
    open class func createOAuthConnection( redirectBase: String,  oAuthConnectionType: OAuthConnectionType_createOAuthConnection,  emailAddress: String? = nil) -> Promise<CreateOAuthConnectionResult> {
        let deferred = Promise<CreateOAuthConnectionResult>.pending()
        createOAuthConnectionWithRequestBuilder(redirectBase: redirectBase, oAuthConnectionType: oAuthConnectionType, emailAddress: emailAddress).execute { result in
            switch result {
            case let .success(response):
                deferred.resolver.fulfill(response.body)
            case let .failure(error):
                deferred.resolver.reject(error)
            }
        }
        return deferred.promise
    }

    /**
     Create an OAuth connection
     - POST /oauth-connection
     - Configure an inbox for OAuth sync with MailSlurp
     - API Key:
       - type: apiKey x-api-key (HEADER)
       - name: API_KEY
     - parameter redirectBase: (query)  
     - parameter oAuthConnectionType: (query)  
     - parameter emailAddress: (query)  (optional)
     - returns: RequestBuilder<CreateOAuthConnectionResult> 
     */
    open class func createOAuthConnectionWithRequestBuilder(redirectBase: String, oAuthConnectionType: OAuthConnectionType_createOAuthConnection, emailAddress: String? = nil) -> RequestBuilder<CreateOAuthConnectionResult> {
        let localVariablePath = "/oauth-connection"
        let localVariableURLString = mailslurpAPI.basePath + localVariablePath
        let localVariableParameters: [String: Any]? = nil

        var localVariableUrlComponents = URLComponents(string: localVariableURLString)
        localVariableUrlComponents?.queryItems = APIHelper.mapValuesToQueryItems([
            "redirectBase": (wrappedValue: redirectBase.encodeToJSON(), isExplode: true),
            "oAuthConnectionType": (wrappedValue: oAuthConnectionType.encodeToJSON(), isExplode: true),
            "emailAddress": (wrappedValue: emailAddress?.encodeToJSON(), isExplode: true),
        ])

        let localVariableNillableHeaders: [String: Any?] = [
            :
        ]

        let localVariableHeaderParameters = APIHelper.rejectNilHeaders(localVariableNillableHeaders)

        let localVariableRequestBuilder: RequestBuilder<CreateOAuthConnectionResult>.Type = mailslurpAPI.requestBuilderFactory.getBuilder()

        return localVariableRequestBuilder.init(method: "POST", URLString: (localVariableUrlComponents?.string ?? localVariableURLString), parameters: localVariableParameters, headers: localVariableHeaderParameters, requiresAuthentication: true)
    }

    /**
     Exchange authorization code for access token and create inbox
     
     - parameter authorizationCode: (query)  
     - parameter redirectUri: (query)  
     - returns: Promise<CreateOAuthExchangeResult>
     */
    open class func exchangeAuthorizationTokenAndCreateOrUpdateInbox( authorizationCode: String,  redirectUri: String) -> Promise<CreateOAuthExchangeResult> {
        let deferred = Promise<CreateOAuthExchangeResult>.pending()
        exchangeAuthorizationTokenAndCreateOrUpdateInboxWithRequestBuilder(authorizationCode: authorizationCode, redirectUri: redirectUri).execute { result in
            switch result {
            case let .success(response):
                deferred.resolver.fulfill(response.body)
            case let .failure(error):
                deferred.resolver.reject(error)
            }
        }
        return deferred.promise
    }

    /**
     Exchange authorization code for access token and create inbox
     - POST /oauth-connection/oauth-exchange/google
     - Exchange an OAuth code for an access token and create an inbox connection in MailSlurp
     - API Key:
       - type: apiKey x-api-key (HEADER)
       - name: API_KEY
     - parameter authorizationCode: (query)  
     - parameter redirectUri: (query)  
     - returns: RequestBuilder<CreateOAuthExchangeResult> 
     */
    open class func exchangeAuthorizationTokenAndCreateOrUpdateInboxWithRequestBuilder(authorizationCode: String, redirectUri: String) -> RequestBuilder<CreateOAuthExchangeResult> {
        let localVariablePath = "/oauth-connection/oauth-exchange/google"
        let localVariableURLString = mailslurpAPI.basePath + localVariablePath
        let localVariableParameters: [String: Any]? = nil

        var localVariableUrlComponents = URLComponents(string: localVariableURLString)
        localVariableUrlComponents?.queryItems = APIHelper.mapValuesToQueryItems([
            "authorizationCode": (wrappedValue: authorizationCode.encodeToJSON(), isExplode: true),
            "redirectUri": (wrappedValue: redirectUri.encodeToJSON(), isExplode: true),
        ])

        let localVariableNillableHeaders: [String: Any?] = [
            :
        ]

        let localVariableHeaderParameters = APIHelper.rejectNilHeaders(localVariableNillableHeaders)

        let localVariableRequestBuilder: RequestBuilder<CreateOAuthExchangeResult>.Type = mailslurpAPI.requestBuilderFactory.getBuilder()

        return localVariableRequestBuilder.init(method: "POST", URLString: (localVariableUrlComponents?.string ?? localVariableURLString), parameters: localVariableParameters, headers: localVariableHeaderParameters, requiresAuthentication: true)
    }
}
